# Workflow çš„åç¨±ï¼Œé¡¯ç¤ºåœ¨ GitHub Actions é ç±¤ä¸­
name: Hourly Windows Script Runner

# --------------------------
# è§¸ç™¼æ¢ä»¶ (Triggers)
# --------------------------
on:
  # 1. æ’ç¨‹è§¸ç™¼ï¼šæ¯å°æ™‚çš„ç¬¬ 0 åˆ†é˜è‡ªå‹•é‹è¡Œ (UTC æ™‚é–“)
  schedule:
    # cron èªæ³•: åˆ† æ™‚ æ—¥ æœˆ é€±ã€‚ '0 * * * *' ä»£è¡¨æ¯å°æ™‚çš„æ•´é»
    - cron: '0 * * * *' 
  
  # 2. æ‰‹å‹•è§¸ç™¼ï¼šå…è¨±ä½¿ç”¨è€…åœ¨ Actions é é¢é»æ“Šã€ŒRun workflowã€æŒ‰éˆ•ç«‹å³åŸ·è¡Œ
  workflow_dispatch:
    # é€™è£¡å¯ä»¥å®šç¾©è¼¸å…¥åƒæ•¸ï¼Œä½†é€™æ¬¡ç¯„ä¾‹æˆ‘å€‘ä¿æŒç°¡å–®

# --------------------------
# å·¥ä½œä»»å‹™ (Jobs)
# --------------------------
jobs:
  run-script:
    # ä½¿ç”¨ Windows ç’°å¢ƒåŸ·è¡Œ (å› ç‚ºæ‚¨çš„éŒ¯èª¤è¨Šæ¯è·¯å¾‘æ˜¯ Windows é¢¨æ ¼ D:\a\...)
    runs-on: windows-latest 
    
    # ä»»å‹™æ­¥é©Ÿ (Steps)
    steps:
      # æ­¥é©Ÿ 1: æª¢å‡ºï¼ˆCloneï¼‰å„²å­˜åº«ç¨‹å¼ç¢¼
      - name: Checkout repository
        uses: actions/checkout@v4
        
      # æ­¥é©Ÿ 2: è¨­å®š Python ç’°å¢ƒ
      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          # å»ºè­°ä½¿ç”¨è¼ƒæ–°çš„ Python 3 ç‰ˆæœ¬
          python-version: '3.10' 
          
      # æ­¥é©Ÿ 3: å®‰è£ä¾è³´ (è§£æ±º ModuleNotFoundError: requests)
      - name: Install dependencies from requirements.txt
        run: |
          # æª¢æŸ¥ä¸¦å‡ç´š pip
          python -m pip install --upgrade pip
          # å®‰è£ requirements.txt ä¸­åˆ—å‡ºçš„æ‰€æœ‰å‡½å¼åº« (åŒ…å« requests)
          pip install -r requirements.txt
        # æ³¨æ„: åœ¨ Windows Runner ä¸­ï¼Œé€™è£¡æœƒä½¿ç”¨ PowerShell æˆ– CMD åŸ·è¡Œå‘½ä»¤
        
      # æ­¥é©Ÿ 4: åŸ·è¡Œæ‚¨çš„ Python è…³æœ¬
      - name: Execute Python Script
        # ä½¿ç”¨ python å‘½ä»¤åŸ·è¡Œæ‚¨çš„è…³æœ¬ã€‚
        # æ³¨æ„ï¼šé›–ç„¶æ‚¨çš„åŸå§‹è·¯å¾‘æœ‰ Unicode è·³è„«å­—å…ƒï¼Œä½†åœ¨ Actions ç’°å¢ƒä¸­ç›´æ¥ä½¿ç”¨ä¸­æ–‡æª”åæ›´å¸¸è¦‹ã€‚
        # ç”±æ–¼æ‚¨æä¾›çš„éŒ¯èª¤è¨Šæ¯è·¯å¾‘æ˜¯: D:\a\autosend\autosend\\u5c0f\u6642\u5373\u6642-\u81ea\u52d5.py
        # é€™æš—ç¤ºæ‚¨çš„ç¨‹å¼ç¢¼ä½æ–¼å°ˆæ¡ˆæ ¹ç›®éŒ„ä¸‹çš„ä¸€å€‹åç‚ºã€Œautosendã€çš„è³‡æ–™å¤¾å…§ã€‚
        run: |
          python autosend/å°æ™‚å³æ™‚-è‡ªå‹•.py
        
        # ğŸ’¡ æ³¨æ„: å¦‚æœæ‚¨çš„æª”æ¡ˆåçœŸçš„æ˜¯ Unicode è·³è„«å­—å…ƒ (ä¾‹å¦‚åœ¨ Git ä¸­è¢«ç·¨ç¢¼)ï¼Œ
        # è«‹èª¿æ•´ç‚ºå¯¦éš›çš„æª”æ¡ˆè·¯å¾‘ã€‚é€™è£¡å‡è¨­æ‚¨è…³æœ¬åç¨±æ˜¯ã€Œå°æ™‚å³æ™‚-è‡ªå‹•.pyã€ã€‚