# Workflow çš„åç¨±ï¼Œé¡¯ç¤ºåœ¨ GitHub Actions é ç±¤ä¸­
name: Hourly Autosend Script Runner

# --------------------------
# è§¸ç™¼æ¢ä»¶ (Triggers)
# --------------------------
on:
  # 1. æ’ç¨‹è§¸ç™¼ï¼šæ¯å°æ™‚çš„ç¬¬ 0 åˆ†é˜è‡ªå‹•é‹è¡Œ (UTC æ™‚é–“)
  schedule:
    - cron: '0 * * * *' 
  
  # 2. æ‰‹å‹•è§¸ç™¼ï¼šå…è¨±ä½¿ç”¨è€…åœ¨ Actions é é¢é»æ“Šã€ŒRun workflowã€æŒ‰éˆ•ç«‹å³åŸ·è¡Œ
  workflow_dispatch:
    
# --------------------------
# å·¥ä½œä»»å‹™ (Jobs)
# --------------------------
jobs:
  run-autosend:
    # ä½¿ç”¨ Windows ç’°å¢ƒï¼Œç¬¦åˆæ‚¨ä¹‹å‰éŒ¯èª¤è¨Šæ¯ä¸­çš„ D:\ è·¯å¾‘
    runs-on: windows-latest 
    
    steps:
      # æ­¥é©Ÿ 1: æª¢å‡ºï¼ˆCloneï¼‰å„²å­˜åº«ç¨‹å¼ç¢¼
      # é€™æ˜¯å¿…é ˆçš„ï¼Œå®ƒå°‡æ‚¨çš„ç¨‹å¼ç¢¼æ”¾åˆ° Runner çš„å·¥ä½œç›®éŒ„
      - name: Checkout repository
        uses: actions/checkout@v4
        
      # æ­¥é©Ÿ 2: è¨­å®š Python ç’°å¢ƒ
      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.10' # ä½¿ç”¨ä¸€å€‹ç©©å®šçš„ç‰ˆæœ¬
          
      # æ­¥é©Ÿ 3: å®‰è£ä¾è³´ (è§£æ±º ModuleNotFoundError: requests)
      - name: Install dependencies (requests)
        run: |
          python -m pip install --upgrade pip
          # é€™è£¡å‡è¨­æ‚¨åœ¨å°ˆæ¡ˆæ ¹ç›®éŒ„æœ‰ requirements.txt ä¸”å…§å®¹ç‚º requests
          pip install -r requirements.txt
        
      # æ­¥é©Ÿ 4: åŸ·è¡Œæ‚¨çš„ Python è…³æœ¬ (ä¿®æ­£è·¯å¾‘)
      - name: Execute Python Script
        # **é—œéµä¿®æ­£ï¼š** ä½¿ç”¨çµ•å°æ­£ç¢ºçš„ç›¸å°è·¯å¾‘ã€‚
        # æ ¹æ“šæ‚¨å°ˆæ¡ˆçµæ§‹ (simononetu/autosend)ï¼Œè…³æœ¬é€šå¸¸ä½æ–¼æ ¹ç›®éŒ„ä¸‹çš„ autosend è³‡æ–™å¤¾å…§ã€‚
        # æˆ‘å€‘å°‡è·¯å¾‘è¨­å®šç‚ºç›¸å°æ–¼å·¥ä½œç›®éŒ„çš„ './autosend/å°æ™‚å³æ™‚-è‡ªå‹•.py'
        run: |
          python ./autosend/å°æ™‚å³æ™‚-è‡ªå‹•.py
          
      # ğŸ’¡ æ³¨æ„: å¦‚æœè…³æœ¬åç¨±çš„ä¸­æ–‡ç·¨ç¢¼é€ æˆå•é¡Œï¼Œæ‚¨å¯ä»¥å˜—è©¦å°‡è…³æœ¬åç¨±æ”¹ç‚ºç´”è‹±æ–‡ã€‚
      # ä¾‹å¦‚ï¼šå°‡ 'å°æ™‚å³æ™‚-è‡ªå‹•.py' æ”¹ç‚º 'hourly_script.py'